function faceDetectionJquery(e,t){$(".person_img>img").faceDetection({complete:function(o){if(!1===o)return console.log("jquery.facedetection returned false");e.boost=Array.prototype.slice.call(o,0).map(function(e){return{x:e.x,y:e.y,width:e.width,height:e.height,weight:1}}),t()}})}function cropImg(e){if(e.length){var t={},o={debug:!0,ruleOfThirds:!0,width:250,height:250};e.on("load",function(){window.setTimeout(function(){var e=this;t[e.src]||(t[e.src]=!0,faceDetectionJquery(o,function(){smartcrop.crop(e,o,function(t){var a=t.topCrop,n=$("<canvas>")[0],i=n.getContext("2d");n.width=o.width,n.height=o.height,i.drawImage(e,a.x,a.y,a.width,a.height,0,0,n.width,n.height),$(e).hide().after(n)})}))}.bind(this),100)}),this.complete&&$(this).load()}}function showAvatar(e){if(arguments.length){var t=["#1abc9c","#2ecc71","#3498db","#9b59b6","#34495e","#16a085","#27ae60","#2980b9","#8e44ad","#2c3e50","#f1c40f","#e67e22","#e74c3c","#95a5a6","#f39c12","#d35400","#c0392b","#bdc3c7","#7f8c8d"],o=e.split(" "),a=o[0].charAt(0).toUpperCase()+o[1].charAt(0).toUpperCase(),n=(a.charCodeAt(0)-65)%19,i=document.getElementById("canvas-img"),r=i.getContext("2d"),s=$(i).data("w"),l=$(i).data("h"),d=s,c=l;window.devicePixelRatio&&($(i).attr("width",s*window.devicePixelRatio),$(i).attr("height",l*window.devicePixelRatio),$(i).css("width",d),$(i).css("height",c),r.scale(window.devicePixelRatio,window.devicePixelRatio)),r.fillStyle=t[n],r.fillRect(0,0,i.width,i.height),r.font="50px Arial",r.textAlign="center",r.fillStyle="#FFF",r.fillText(a,d/2,c/1.5)}else console.log("Function has no arguments passed!")}function showProgress(){$("#loader").show(),$("#enter").hide(),$("#card").hide(),$("#enter_alert").hide()}function showEnter(){$("#loader").hide(),$("#enter").show(),$("#card").hide(),$("#card").show(),$("#enter_alert").hide()}function showCard(){$("#loader").hide(),$("#enter").hide(),$("#card").show(),$("#enter_alert").hide()}function showAlert(e,t){$("#enter_alert").show(),401==e&&($(".form_wrap").addClass("swing animated"),$("#enter_alert").text("Неверный логин или пароль!")),0==e?($("#enter_alert").text("Время ожидания истекло!"),$(".form_wrap").addClass("swing animated")):(console.log(e,t),$(".form_wrap").addClass("swing animated"),$("#enter_alert").text("Ошибка на сервере!"))}function getCard(e){showProgress();var t=$.ajax({url:"/api/v1/login2/info",contentType:"application/json; charset=utf-8",method:"get",dataType:"json",timeout:1e4});t.done(function(e){var t=get_params(window.location.search).back_url;if(t)return t=decodeURIComponent(t),void redirect(t);showCard(),$("#card").html($("#cardTemplate").render(e.details)),null==e.details.icon_profile?showAvatar(e.details.first_name+" "+e.details.last_name):cropImg($(".person_img>img"))}),t.fail(function(t){showEnter(),e||showAlert(t.status,t.responseText)})}function doLogin(){showProgress();var e=$("#user").val(),t=$("#password").val();$.ajax({url:"/api/v1/login2/login",data:JSON.stringify({user:e,password:t}),contentType:"application/json; charset=utf-8",method:"post",dataType:"json",timeout:1e4}).done(function(e){getCard(!1)}).fail(function(e){showEnter(),showAlert(e.status,e.responseText)})}function doLogout(){showProgress(),$.ajax({url:"/api/v1/login2/logout",contentType:"application/json; charset=utf-8",method:"get",dataType:"json",timeout:1e4}).done(function(e){getCard(!0)}).fail(function(e){showEnter(),showAlert(e.status,e.responseText)})}function doCancel(){var e=get_params(window.location.search).back_url;e&&(0===sizeObj(get_params(e=decodeURIComponent(e)))?e+="?":e+="&",redirect(e+="isCancel=yes"))}function get_params(e){var t={};return e.replace(location.hash,"").replace(/[?&]+([^=&]+)=?([^&]*)?/gi,function(e,o,a){t[o]=void 0!==a?a:""}),t}function redirect(e){var t=navigator.userAgent.toLowerCase(),o=-1!==t.indexOf("msie"),a=parseInt(t.substr(4,2),10);if(o&&a<9){var n=document.createElement("a");n.href=e,document.body.appendChild(n),n.click()}else window.location.href=e}function sizeObj(e){var t,o=0;for(t in e)e.hasOwnProperty(t)&&o++;return o}$(function(){getCard(!0);var e={error:!1,details:{username:"korshunov.ev",user_id:21086,first_name:"Иван",last_name:"Петров",middle_name:"Валерьевич",main_email:null,icon_profile:"img/val.jpg",structure:[{type:"студент",number:"1698542",dep:"ИКНТ",sub_dep:"130120/25",email:null},{type:"старший преподаватель",number:"01256",dep:"ИКНТ",sub_dep:"КИТ",email:null}],meta:{post_address:null,phone:null,date_of_birth:null},permissions:null},authorize:!0};showCard(),$("#card").html($("#cardTemplate").render(e.details)),null==e.details.icon_profile?showAvatar(e.details.first_name+" "+e.details.last_name):cropImg($(".person_img>img")),$("#enter").on("submit",function(e){e.preventDefault(),doLogin()}),$("#doLogin").click(function(){doLogin()}),$("#doCancel").click(function(){doCancel()}),$("#doLogout").click(function(){doLogout()}),$(".owl-carousel").owlCarousel({items:1,pagination:!0,nav:!0,loop:!0,autoplay:!0,autoplayTimeout:5e3,autoplayHoverPause:!0,smartSpeed:450,navText:['<i class="fa fa-chevron-left"></i>','<i class="fa fa-chevron-right"></i>']})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxvZ2luLmpzIl0sIm5hbWVzIjpbImZhY2VEZXRlY3Rpb25KcXVlcnkiLCJvcHRpb25zIiwiY2FsbGJhY2siLCIkIiwiZmFjZURldGVjdGlvbiIsImNvbXBsZXRlIiwiZmFjZXMiLCJjb25zb2xlIiwibG9nIiwiYm9vc3QiLCJBcnJheSIsInByb3RvdHlwZSIsInNsaWNlIiwiY2FsbCIsIm1hcCIsImZhY2UiLCJ4IiwieSIsIndpZHRoIiwiaGVpZ2h0Iiwid2VpZ2h0IiwiY3JvcEltZyIsImNySW1nIiwibGVuZ3RoIiwicHJvY2Vzc2VkIiwiZGVidWciLCJydWxlT2ZUaGlyZHMiLCJvbiIsIndpbmRvdyIsInNldFRpbWVvdXQiLCJpbWciLCJ0aGlzIiwic3JjIiwic21hcnRjcm9wIiwiY3JvcCIsInJlc3VsdCIsInRvcENyb3AiLCJjYW52YXMiLCJjdHgiLCJnZXRDb250ZXh0IiwiZHJhd0ltYWdlIiwiaGlkZSIsImFmdGVyIiwiYmluZCIsImxvYWQiLCJzaG93QXZhdGFyIiwibmFtZSIsImFyZ3VtZW50cyIsImNvbG91cnMiLCJuYW1lU3BsaXQiLCJzcGxpdCIsImluaXRpYWxzIiwiY2hhckF0IiwidG9VcHBlckNhc2UiLCJjb2xvdXJJbmRleCIsImNoYXJDb2RlQXQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiY29udGV4dCIsImNhbnZhc1dpZHRoIiwiZGF0YSIsImNhbnZhc0hlaWdodCIsImNhbnZhc0Nzc1dpZHRoIiwiY2FudmFzQ3NzSGVpZ2h0IiwiZGV2aWNlUGl4ZWxSYXRpbyIsImF0dHIiLCJjc3MiLCJzY2FsZSIsImZpbGxTdHlsZSIsImZpbGxSZWN0IiwiZm9udCIsInRleHRBbGlnbiIsImZpbGxUZXh0Iiwic2hvd1Byb2dyZXNzIiwic2hvdyIsInNob3dFbnRlciIsInNob3dDYXJkIiwic2hvd0FsZXJ0IiwiU3RhdHVzIiwiVGV4dCIsImFkZENsYXNzIiwidGV4dCIsImdldENhcmQiLCJpc0ZpcnN0IiwicmVxSW5mbyIsImFqYXgiLCJ1cmwiLCJjb250ZW50VHlwZSIsIm1ldGhvZCIsImRhdGFUeXBlIiwidGltZW91dCIsImRvbmUiLCJiYWNrX3VybCIsImdldF9wYXJhbXMiLCJsb2NhdGlvbiIsInNlYXJjaCIsImRlY29kZVVSSUNvbXBvbmVudCIsInJlZGlyZWN0IiwiaHRtbCIsInJlbmRlciIsImRldGFpbHMiLCJpY29uX3Byb2ZpbGUiLCJmaXJzdF9uYW1lIiwibGFzdF9uYW1lIiwiZmFpbCIsImh0dHBPYmoiLCJzdGF0dXMiLCJyZXNwb25zZVRleHQiLCJkb0xvZ2luIiwidXNlciIsInZhbCIsInBhc3N3b3JkIiwiSlNPTiIsInN0cmluZ2lmeSIsImRvTG9nb3V0IiwiZG9DYW5jZWwiLCJzaXplT2JqIiwidmFycyIsInJlcGxhY2UiLCJoYXNoIiwibSIsImtleSIsInZhbHVlIiwidW5kZWZpbmVkIiwidWEiLCJuYXZpZ2F0b3IiLCJ1c2VyQWdlbnQiLCJ0b0xvd2VyQ2FzZSIsImlzSUUiLCJpbmRleE9mIiwidmVyc2lvbiIsInBhcnNlSW50Iiwic3Vic3RyIiwibGluayIsImNyZWF0ZUVsZW1lbnQiLCJocmVmIiwiYm9keSIsImFwcGVuZENoaWxkIiwiY2xpY2siLCJvYmoiLCJzaXplIiwiaGFzT3duUHJvcGVydHkiLCJlcnJvciIsInVzZXJuYW1lIiwidXNlcl9pZCIsIm1pZGRsZV9uYW1lIiwibWFpbl9lbWFpbCIsInN0cnVjdHVyZSIsInR5cGUiLCJudW1iZXIiLCJkZXAiLCJzdWJfZGVwIiwiZW1haWwiLCJtZXRhIiwicG9zdF9hZGRyZXNzIiwicGhvbmUiLCJkYXRlX29mX2JpcnRoIiwicGVybWlzc2lvbnMiLCJhdXRob3JpemUiLCJlIiwicHJldmVudERlZmF1bHQiLCJvd2xDYXJvdXNlbCIsIml0ZW1zIiwicGFnaW5hdGlvbiIsIm5hdiIsImxvb3AiLCJhdXRvcGxheSIsImF1dG9wbGF5VGltZW91dCIsImF1dG9wbGF5SG92ZXJQYXVzZSIsInNtYXJ0U3BlZWQiLCJuYXZUZXh0Il0sIm1hcHBpbmdzIjoiQUE2RkEs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QUFLLEVBQ0xDLFVBQVMsRUFDVEMsZ0JBQWdCLElBQ2hCQyxvQkFBbUIsRUFHbkJDLFdBQVcsSUFDWEMsU0FBUyxxQ0FBcUMiLCJmaWxlIjoibG9naW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIkKGZ1bmN0aW9uKCl7XHJcbiAgICBnZXRDYXJkKHRydWUpO1xyXG5cclxuICAgIC8qKioqKioqKioqXHJcbiAgICAgKiBTVEFSVCBURVNUXHJcbiAgICAgKioqKioqKioqKiovXHJcblxyXG4gICAgdmFyIGRhdGEgPXtcclxuICAgICAgICBcImVycm9yXCI6IGZhbHNlLFxyXG4gICAgICAgIFwiZGV0YWlsc1wiOiB7XHJcbiAgICAgICAgICAgIFwidXNlcm5hbWVcIjogXCJrb3JzaHVub3YuZXZcIixcclxuICAgICAgICAgICAgXCJ1c2VyX2lkXCI6IDIxMDg2LFxyXG4gICAgICAgICAgICBcImZpcnN0X25hbWVcIjogXCLQmNCy0LDQvVwiLFxyXG4gICAgICAgICAgICBcImxhc3RfbmFtZVwiOiBcItCf0LXRgtGA0L7QslwiLFxyXG4gICAgICAgICAgICBcIm1pZGRsZV9uYW1lXCI6IFwi0JLQsNC70LXRgNGM0LXQstC40YdcIixcclxuICAgICAgICAgICAgXCJtYWluX2VtYWlsXCI6IG51bGwsXHJcbiAgICAgICAgICAgIFwiaWNvbl9wcm9maWxlXCI6XCJpbWcvdmFsLmpwZ1wiLFxyXG4gICAgICAgICAgICBcInN0cnVjdHVyZVwiOltcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBcInR5cGVcIjogXCLRgdGC0YPQtNC10L3RglwiLFxyXG4gICAgICAgICAgICAgICAgICAgIFwibnVtYmVyXCI6IFwiMTY5ODU0MlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiZGVwXCI6IFwi0JjQmtCd0KJcIixcclxuICAgICAgICAgICAgICAgICAgICBcInN1Yl9kZXBcIjogXCIxMzAxMjAvMjVcIixcclxuICAgICAgICAgICAgICAgICAgICBcImVtYWlsXCI6IG51bGxcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgXCJ0eXBlXCI6IFwi0YHRgtCw0YDRiNC40Lkg0L/RgNC10L/QvtC00LDQstCw0YLQtdC70YxcIixcclxuICAgICAgICAgICAgICAgICAgICBcIm51bWJlclwiOiBcIjAxMjU2XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgXCJkZXBcIjogXCLQmNCa0J3QolwiLFxyXG4gICAgICAgICAgICAgICAgICAgIFwic3ViX2RlcFwiOiBcItCa0JjQolwiLFxyXG4gICAgICAgICAgICAgICAgICAgIFwiZW1haWxcIjogbnVsbFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBdLFxyXG4gICAgICAgICAgICBcIm1ldGFcIjoge1xyXG4gICAgICAgICAgICAgICAgXCJwb3N0X2FkZHJlc3NcIjogbnVsbCxcclxuICAgICAgICAgICAgICAgIFwicGhvbmVcIjogbnVsbCxcclxuICAgICAgICAgICAgICAgIFwiZGF0ZV9vZl9iaXJ0aFwiOiBudWxsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIFwicGVybWlzc2lvbnNcIjogbnVsbFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXCJhdXRob3JpemVcIjogdHJ1ZVxyXG4gICAgfTtcclxuICAgIHNob3dDYXJkKCk7XHJcbiAgICAkKFwiI2NhcmRcIikuaHRtbChcclxuICAgICAgICAkKFwiI2NhcmRUZW1wbGF0ZVwiKS5yZW5kZXIoZGF0YS5kZXRhaWxzKVxyXG4gICAgKTtcclxuXHJcbiAgICBpZihkYXRhLmRldGFpbHMuaWNvbl9wcm9maWxlID09IG51bGwpe1xyXG4gICAgICAgIHNob3dBdmF0YXIoZGF0YS5kZXRhaWxzLmZpcnN0X25hbWUrXCIgXCIrZGF0YS5kZXRhaWxzLmxhc3RfbmFtZSk7XHJcbiAgICB9XHJcbiAgICBlbHNle1xyXG4gICAgICAgIGNyb3BJbWcoJCgnLnBlcnNvbl9pbWc+aW1nJykpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKioqKioqKioqXHJcbiAgICAgKiBFTkQgVEVTVFxyXG4gICAgICoqKioqKioqKioqL1xyXG5cclxuICAgICQoXCIjZW50ZXJcIikub24oJ3N1Ym1pdCcsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIGRvTG9naW4oKTtcclxuICAgIH0pO1xyXG5cclxuICAgICQoXCIjZG9Mb2dpblwiKS5jbGljayhmdW5jdGlvbigpe1xyXG4gICAgICAgIGRvTG9naW4oKVxyXG4gICAgfSk7XHJcblxyXG4gICAgJChcIiNkb0NhbmNlbFwiKS5jbGljayhmdW5jdGlvbigpe1xyXG4gICAgICAgIGRvQ2FuY2VsKClcclxuICAgIH0pO1xyXG5cclxuICAgICQoXCIjZG9Mb2dvdXRcIikuY2xpY2soZnVuY3Rpb24oKXtcclxuICAgICAgICBkb0xvZ291dCgpXHJcbiAgICB9KTtcclxuXHJcbiAgICAkKCcub3dsLWNhcm91c2VsJykub3dsQ2Fyb3VzZWwoe1xyXG4gICAgICAgIGl0ZW1zOjEsXHJcbiAgICAgICAgcGFnaW5hdGlvbjogdHJ1ZSxcclxuICAgICAgICBuYXY6dHJ1ZSxcclxuICAgICAgICBsb29wOnRydWUsXHJcbiAgICAgICAgYXV0b3BsYXk6dHJ1ZSxcclxuICAgICAgICBhdXRvcGxheVRpbWVvdXQ6NTAwMCxcclxuICAgICAgICBhdXRvcGxheUhvdmVyUGF1c2U6dHJ1ZSxcclxuICAgICAgICAvL2FuaW1hdGVPdXQ6ICd6b29tT3V0JyxcclxuICAgICAgICAvL2FuaW1hdGVJbjogJ3pvb21JbicsXHJcbiAgICAgICAgc21hcnRTcGVlZDo0NTAsXHJcbiAgICAgICAgbmF2VGV4dDpbJzxpIGNsYXNzPVwiZmEgZmEtY2hldnJvbi1sZWZ0XCI+PC9pPicsJzxpIGNsYXNzPVwiZmEgZmEtY2hldnJvbi1yaWdodFwiPjwvaT4nXVxyXG4gICAgfSk7XHJcblxyXG59KTtcclxuXHJcbi8v0YTRg9C90LrRhtC40Y8g0YDQsNGB0L/QvtC30L3QsNCy0LDQvdC40Y8g0LvQuNGGXHJcblxyXG5mdW5jdGlvbiBmYWNlRGV0ZWN0aW9uSnF1ZXJ5KG9wdGlvbnMsIGNhbGxiYWNrKSB7XHJcbiAgICAkKCcucGVyc29uX2ltZz5pbWcnKS5mYWNlRGV0ZWN0aW9uKHtcclxuICAgICAgICBjb21wbGV0ZTogZnVuY3Rpb24oZmFjZXMpIHtcclxuICAgICAgICAgICAgaWYgKGZhY2VzID09PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbnNvbGUubG9nKCdqcXVlcnkuZmFjZWRldGVjdGlvbiByZXR1cm5lZCBmYWxzZScpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ2pxdWVyeS5mYWNlZGV0ZWN0aW9uIGRldGVjdGVkICcgKyBmYWNlcy5sZW5ndGggKyAnIGZhY2VzJywgZmFjZXMpO1xyXG4gICAgICAgICAgICBvcHRpb25zLmJvb3N0ID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZmFjZXMsIDApLm1hcChmdW5jdGlvbihmYWNlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHg6IGZhY2UueCxcclxuICAgICAgICAgICAgICAgICAgICB5OiBmYWNlLnksXHJcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IGZhY2Uud2lkdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBmYWNlLmhlaWdodCxcclxuICAgICAgICAgICAgICAgICAgICB3ZWlnaHQ6IDEuMFxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBjYWxsYmFjaygpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcblxyXG4vL9GE0YPQvdC60YbQuNGPINGD0LzQvdC+0Lkg0L7QsdGA0LXQt9C60Lgg0KTQvtGC0L7Qs9GA0LDRhNC40LhcclxuXHJcbmZ1bmN0aW9uIGNyb3BJbWcoY3JJbWcpe1xyXG4gICAgaWYgKGNySW1nLmxlbmd0aCl7XHJcbiAgICAgICAgdmFyIHByb2Nlc3NlZCA9IHt9O1xyXG4gICAgICAgIHZhciBvcHRpb25zID0ge1xyXG4gICAgICAgICAgICBkZWJ1ZzogdHJ1ZSxcclxuICAgICAgICAgICAgcnVsZU9mVGhpcmRzOnRydWUsXHJcbiAgICAgICAgICAgIHdpZHRoOiAyNTAsLy/Qt9Cw0L/QsNGBINC60LDRh9C10YHRgtCy0LBcclxuICAgICAgICAgICAgaGVpZ2h0OiAyNTAvL9C30LDQv9Cw0YEg0LrQsNGH0LXRgdGC0LLQsFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgY3JJbWcub24oJ2xvYWQnLGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaW1nID0gdGhpcztcclxuICAgICAgICAgICAgICAgICAgICBpZiAocHJvY2Vzc2VkW2ltZy5zcmNdKSByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc2VkW2ltZy5zcmNdID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgICAgICBmYWNlRGV0ZWN0aW9uSnF1ZXJ5KG9wdGlvbnMsIGZ1bmN0aW9uKCkgeyAvL9C10YHQu9C4INC80LXQtNC70LXQvdC90L4g0LzQvtC20L3QviDQt9Cw0LrQvtC80LzQtdC90YLQuNGA0L7QstCw0YLRjFxyXG4gICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2cob3B0aW9ucyk7XHJcbiAgICAgICAgICAgICAgICAgICAgc21hcnRjcm9wLmNyb3AoaW1nLCBvcHRpb25zLCBmdW5jdGlvbihyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coaW1nLnNyYywgcmVzdWx0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNyb3AgPSByZXN1bHQudG9wQ3JvcDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhbnZhcyA9ICQoJzxjYW52YXM+JylbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzLndpZHRoID0gb3B0aW9ucy53aWR0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzLmhlaWdodCA9IG9wdGlvbnMuaGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdHguZHJhd0ltYWdlKGltZywgY3JvcC54LCBjcm9wLnksIGNyb3Aud2lkdGgsIGNyb3AuaGVpZ2h0LCAwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKGltZykuaGlkZSgpLmFmdGVyKGNhbnZhcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTsgLy/QtdGB0LvQuCDQvNC10LTQu9C10L3QvdC+INC80L7QttC90L4g0LfQsNC60L7QvNC80LXQvdGC0LjRgNC+0LLQsNGC0YxcclxuXHJcbiAgICAgICAgICB9LmJpbmQodGhpcyksIDEwMCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKHRoaXMuY29tcGxldGUpIHtcclxuICAgICAgICAgICAgJCh0aGlzKS5sb2FkKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG4vL9GE0YPQvdC60YbQuNGPINCz0LXQvdC10YDQsNGG0LjQuCDQsNCy0LDRgtCw0YDQsCDQuNC3INCk0JjQnlxyXG5mdW5jdGlvbiBzaG93QXZhdGFyKG5hbWUpe1xyXG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGgpIHtcclxuXHJcbiAgICAgICAgdmFyIGNvbG91cnMgPSBbXCIjMWFiYzljXCIsIFwiIzJlY2M3MVwiLCBcIiMzNDk4ZGJcIiwgXCIjOWI1OWI2XCIsIFwiIzM0NDk1ZVwiLCBcIiMxNmEwODVcIiwgXCIjMjdhZTYwXCIsIFwiIzI5ODBiOVwiLCBcIiM4ZTQ0YWRcIiwgXCIjMmMzZTUwXCIsIFwiI2YxYzQwZlwiLCBcIiNlNjdlMjJcIiwgXCIjZTc0YzNjXCIsIFwiIzk1YTVhNlwiLCBcIiNmMzljMTJcIiwgXCIjZDM1NDAwXCIsIFwiI2MwMzkyYlwiLCBcIiNiZGMzYzdcIiwgXCIjN2Y4YzhkXCJdO1xyXG5cclxuICAgICAgICB2YXIgbmFtZVNwbGl0ID0gbmFtZS5zcGxpdChcIiBcIiksXHJcbiAgICAgICAgICAgIGluaXRpYWxzID0gbmFtZVNwbGl0WzBdLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgbmFtZVNwbGl0WzFdLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpO1xyXG5cclxuICAgICAgICB2YXIgY2hhckluZGV4ID0gaW5pdGlhbHMuY2hhckNvZGVBdCgwKSAtIDY1LFxyXG4gICAgICAgICAgICBjb2xvdXJJbmRleCA9IGNoYXJJbmRleCAlIDE5O1xyXG5cclxuICAgICAgICB2YXIgY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjYW52YXMtaW1nXCIpO1xyXG4gICAgICAgIHZhciBjb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcclxuXHJcbiAgICAgICAgdmFyIGNhbnZhc1dpZHRoID0gJChjYW52YXMpLmRhdGEoXCJ3XCIpLFxyXG4gICAgICAgICAgICBjYW52YXNIZWlnaHQgPSAkKGNhbnZhcykuZGF0YShcImhcIiksXHJcbiAgICAgICAgICAgIGNhbnZhc0Nzc1dpZHRoID0gY2FudmFzV2lkdGgsXHJcbiAgICAgICAgICAgIGNhbnZhc0Nzc0hlaWdodCA9IGNhbnZhc0hlaWdodDtcclxuXHJcbiAgICAgICAgaWYgKHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvKSB7XHJcbiAgICAgICAgICAgICQoY2FudmFzKS5hdHRyKFwid2lkdGhcIiwgY2FudmFzV2lkdGggKiB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyk7XHJcbiAgICAgICAgICAgICQoY2FudmFzKS5hdHRyKFwiaGVpZ2h0XCIsIGNhbnZhc0hlaWdodCAqIHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvKTtcclxuICAgICAgICAgICAgJChjYW52YXMpLmNzcyhcIndpZHRoXCIsIGNhbnZhc0Nzc1dpZHRoKTtcclxuICAgICAgICAgICAgJChjYW52YXMpLmNzcyhcImhlaWdodFwiLCBjYW52YXNDc3NIZWlnaHQpO1xyXG4gICAgICAgICAgICBjb250ZXh0LnNjYWxlKHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvLCB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb250ZXh0LmZpbGxTdHlsZSA9IGNvbG91cnNbY29sb3VySW5kZXhdO1xyXG4gICAgICAgIGNvbnRleHQuZmlsbFJlY3QgKDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7XHJcbiAgICAgICAgY29udGV4dC5mb250ID0gXCI1MHB4IEFyaWFsXCI7XHJcbiAgICAgICAgY29udGV4dC50ZXh0QWxpZ24gPSBcImNlbnRlclwiO1xyXG4gICAgICAgIGNvbnRleHQuZmlsbFN0eWxlID0gXCIjRkZGXCI7XHJcbiAgICAgICAgY29udGV4dC5maWxsVGV4dChpbml0aWFscywgY2FudmFzQ3NzV2lkdGggLyAyLCBjYW52YXNDc3NIZWlnaHQgLyAxLjUpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnRnVuY3Rpb24gaGFzIG5vIGFyZ3VtZW50cyBwYXNzZWQhJyk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNob3dQcm9ncmVzcygpIHtcclxuICAgICQoXCIjbG9hZGVyXCIpLnNob3coKTtcclxuICAgICQoXCIjZW50ZXJcIikuaGlkZSgpO1xyXG4gICAgJChcIiNjYXJkXCIpLmhpZGUoKTtcclxuICAgICQoXCIjZW50ZXJfYWxlcnRcIikuaGlkZSgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzaG93RW50ZXIoKSB7XHJcbiAgICAkKFwiI2xvYWRlclwiKS5oaWRlKCk7XHJcbiAgICAkKFwiI2VudGVyXCIpLnNob3coKTtcclxuICAgICQoXCIjY2FyZFwiKS5oaWRlKCk7XHJcbiAgICAkKFwiI2NhcmRcIikuc2hvdygpO1xyXG4gICAgJChcIiNlbnRlcl9hbGVydFwiKS5oaWRlKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNob3dDYXJkKCkge1xyXG4gICAgJChcIiNsb2FkZXJcIikuaGlkZSgpO1xyXG4gICAgJChcIiNlbnRlclwiKS5oaWRlKCk7XHJcbiAgICAkKFwiI2NhcmRcIikuc2hvdygpO1xyXG4gICAgJChcIiNlbnRlcl9hbGVydFwiKS5oaWRlKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNob3dBbGVydChTdGF0dXMsIFRleHQpIHtcclxuXHJcbiAgICAkKFwiI2VudGVyX2FsZXJ0XCIpLnNob3coKTtcclxuICAgIGlmIChTdGF0dXMgPT0gNDAxKSB7XHJcbiAgICAgICAgJChcIi5mb3JtX3dyYXBcIikuYWRkQ2xhc3MoXCJzd2luZyBhbmltYXRlZFwiKTsvL9Cw0L3QuNC80LDRhtC40Y8g0YTQvtGA0LzRi1xyXG4gICAgICAgICQoXCIjZW50ZXJfYWxlcnRcIikudGV4dChcItCd0LXQstC10YDQvdGL0Lkg0LvQvtCz0LjQvSDQuNC70Lgg0L/QsNGA0L7Qu9GMIVwiKTtcclxuICAgIH1pZiAoU3RhdHVzID09IDApIHtcclxuICAgICAgICAkKFwiI2VudGVyX2FsZXJ0XCIpLnRleHQoXCLQktGA0LXQvNGPINC+0LbQuNC00LDQvdC40Y8g0LjRgdGC0LXQutC70L4hXCIpO1xyXG4gICAgICAgICQoXCIuZm9ybV93cmFwXCIpLmFkZENsYXNzKFwic3dpbmcgYW5pbWF0ZWRcIik7Ly/QsNC90LjQvNCw0YbQuNGPINGE0L7RgNC80YtcclxuICAgIH1lbHNle1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFN0YXR1cywgVGV4dCk7XHJcbiAgICAgICAgJChcIi5mb3JtX3dyYXBcIikuYWRkQ2xhc3MoXCJzd2luZyBhbmltYXRlZFwiKTtcclxuICAgICAgICAkKFwiI2VudGVyX2FsZXJ0XCIpLnRleHQoXCLQntGI0LjQsdC60LAg0L3QsCDRgdC10YDQstC10YDQtSFcIik7Ly/QsNC90LjQvNCw0YbQuNGPINGE0L7RgNC80YtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0Q2FyZChpc0ZpcnN0KSB7XHJcblxyXG4gICAgc2hvd1Byb2dyZXNzKCk7XHJcblxyXG4gICAgdmFyIHJlcUluZm8gPSAkLmFqYXgoe1xyXG4gICAgICAgIHVybDogXCIvYXBpL3YxL2xvZ2luMi9pbmZvXCIsXHJcbiAgICAgICAgY29udGVudFR5cGU6ICdhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04JyxcclxuICAgICAgICBtZXRob2Q6IFwiZ2V0XCIsXHJcbiAgICAgICAgZGF0YVR5cGU6IFwianNvblwiLFxyXG4gICAgICAgIHRpbWVvdXQ6IDEwMDAwXHJcbiAgICB9KTtcclxuXHJcbiAgICByZXFJbmZvLmRvbmUoZnVuY3Rpb24gKGRhdGEpIHtcclxuXHJcbiAgICAgICAgdmFyIHBhcmFtcz0gZ2V0X3BhcmFtcyh3aW5kb3cubG9jYXRpb24uc2VhcmNoKTtcclxuXHJcbiAgICAgICAgdmFyIGJhY2tfdXJsID0gcGFyYW1zW1wiYmFja191cmxcIl07XHJcblxyXG4gICAgICAgIGlmIChiYWNrX3VybCkge1xyXG5cclxuICAgICAgICAgICAgYmFja191cmwgPSBkZWNvZGVVUklDb21wb25lbnQoYmFja191cmwpO1xyXG4gICAgICAgICAgICByZWRpcmVjdChiYWNrX3VybCk7XHJcbiAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgc2hvd0NhcmQoKTtcclxuICAgICAgICAkKFwiI2NhcmRcIikuaHRtbChcclxuICAgICAgICAgICAgJChcIiNjYXJkVGVtcGxhdGVcIikucmVuZGVyKGRhdGEuZGV0YWlscylcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICBpZihkYXRhLmRldGFpbHMuaWNvbl9wcm9maWxlID09IG51bGwpe1xyXG4gICAgICAgICAgICBzaG93QXZhdGFyKGRhdGEuZGV0YWlscy5maXJzdF9uYW1lK1wiIFwiK2RhdGEuZGV0YWlscy5sYXN0X25hbWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICBjcm9wSW1nKCQoJy5wZXJzb25faW1nPmltZycpKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXFJbmZvLmZhaWwoZnVuY3Rpb24gKGh0dHBPYmopIHtcclxuXHJcbiAgICAgICAgc2hvd0VudGVyKCk7XHJcbiAgICAgICAgaWYgKCFpc0ZpcnN0KSBzaG93QWxlcnQoaHR0cE9iai5zdGF0dXMsIGh0dHBPYmoucmVzcG9uc2VUZXh0KTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBkb0xvZ2luKCkge1xyXG5cclxuICAgIHNob3dQcm9ncmVzcygpO1xyXG5cclxuICAgIHZhciB1c2VyID0gJChcIiN1c2VyXCIpLnZhbCgpO1xyXG4gICAgdmFyIHBhc3N3b3JkID0gJChcIiNwYXNzd29yZFwiKS52YWwoKTtcclxuXHJcbiAgICAkLmFqYXgoe1xyXG4gICAgICAgIHVybDogXCIvYXBpL3YxL2xvZ2luMi9sb2dpblwiLFxyXG4gICAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgXCJ1c2VyXCI6IHVzZXIsXHJcbiAgICAgICAgICAgIFwicGFzc3dvcmRcIjogcGFzc3dvcmRcclxuICAgICAgICB9KSxcclxuICAgICAgICBjb250ZW50VHlwZTogJ2FwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLTgnLFxyXG4gICAgICAgIG1ldGhvZDogXCJwb3N0XCIsXHJcbiAgICAgICAgZGF0YVR5cGU6IFwianNvblwiLFxyXG4gICAgICAgIHRpbWVvdXQ6IDEwMDAwXHJcbiAgICB9KVxyXG4gICAgICAgIC5kb25lKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgIGdldENhcmQoZmFsc2UpXHJcbiAgICAgICAgfSlcclxuICAgICAgICAuZmFpbChmdW5jdGlvbiAoaHR0cE9iaikge1xyXG5cclxuICAgICAgICAgICAgc2hvd0VudGVyKCk7XHJcbiAgICAgICAgICAgIHNob3dBbGVydChodHRwT2JqLnN0YXR1cywgaHR0cE9iai5yZXNwb25zZVRleHQpXHJcbiAgICAgICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRvTG9nb3V0KCkge1xyXG5cclxuICAgIHNob3dQcm9ncmVzcygpO1xyXG5cclxuICAgICQuYWpheCh7XHJcbiAgICAgICAgdXJsOiBcIi9hcGkvdjEvbG9naW4yL2xvZ291dFwiLFxyXG4gICAgICAgIGNvbnRlbnRUeXBlOiAnYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOCcsXHJcbiAgICAgICAgbWV0aG9kOiBcImdldFwiLFxyXG4gICAgICAgIGRhdGFUeXBlOiBcImpzb25cIixcclxuICAgICAgICB0aW1lb3V0OiAxMDAwMFxyXG4gICAgfSlcclxuICAgICAgICAuZG9uZShmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICBnZXRDYXJkKHRydWUpXHJcbiAgICAgICAgfSlcclxuICAgICAgICAuZmFpbChmdW5jdGlvbiAoaHR0cE9iaikge1xyXG5cclxuICAgICAgICAgICAgc2hvd0VudGVyKCk7XHJcbiAgICAgICAgICAgIHNob3dBbGVydChodHRwT2JqLnN0YXR1cywgaHR0cE9iai5yZXNwb25zZVRleHQpXHJcbiAgICAgICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRvQ2FuY2VsKCkge1xyXG5cclxuICAgIHZhciBwYXJhbXM9IGdldF9wYXJhbXMod2luZG93LmxvY2F0aW9uLnNlYXJjaCk7XHJcblxyXG4gICAgdmFyIGJhY2tfdXJsID0gcGFyYW1zW1wiYmFja191cmxcIl07XHJcblxyXG4gICAgaWYgKGJhY2tfdXJsKSB7XHJcblxyXG4gICAgICAgIGJhY2tfdXJsID0gZGVjb2RlVVJJQ29tcG9uZW50KGJhY2tfdXJsKTtcclxuXHJcbiAgICAgICAgdmFyIHBhcm1zX2JhY2tfdXJsID0gZ2V0X3BhcmFtcyhiYWNrX3VybCk7XHJcbiAgICAgICAgaWYgKHNpemVPYmoocGFybXNfYmFja191cmwpID09PSAwICkge1xyXG4gICAgICAgICAgICBiYWNrX3VybCA9IGJhY2tfdXJsICsgXCI/XCJcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBiYWNrX3VybCA9IGJhY2tfdXJsICsgXCImXCJcclxuICAgICAgICB9XHJcbiAgICAgICAgYmFja191cmwgPSBiYWNrX3VybCArIFwiaXNDYW5jZWw9eWVzXCI7XHJcblxyXG4gICAgICAgIHJlZGlyZWN0KGJhY2tfdXJsKTtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0X3BhcmFtcyh1cmwpIHtcclxuICAgIHZhciB2YXJzID0ge307XHJcbiAgICB1cmwucmVwbGFjZSggbG9jYXRpb24uaGFzaCwgJycgKS5yZXBsYWNlKFxyXG4gICAgICAgIC9bPyZdKyhbXj0mXSspPT8oW14mXSopPy9naSwgLy8gcmVnZXhwXHJcbiAgICAgICAgZnVuY3Rpb24oIG0sIGtleSwgdmFsdWUgKSB7IC8vIGNhbGxiYWNrXHJcbiAgICAgICAgICAgIHZhcnNba2V5XSA9IHZhbHVlICE9PSB1bmRlZmluZWQgPyB2YWx1ZSA6ICcnO1xyXG4gICAgICAgIH1cclxuICAgICk7XHJcblxyXG4gICAgcmV0dXJuIHZhcnM7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlZGlyZWN0ICh1cmwpIHtcclxuICAgIHZhciB1YSAgICAgICAgPSBuYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCksXHJcbiAgICAgICAgaXNJRSAgICAgID0gdWEuaW5kZXhPZignbXNpZScpICE9PSAtMSxcclxuICAgICAgICB2ZXJzaW9uICAgPSBwYXJzZUludCh1YS5zdWJzdHIoNCwgMiksIDEwKTtcclxuXHJcbiAgICAvLyBJbnRlcm5ldCBFeHBsb3JlciA4IGFuZCBsb3dlclxyXG4gICAgaWYgKGlzSUUgJiYgdmVyc2lvbiA8IDkpIHtcclxuICAgICAgICB2YXIgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcclxuICAgICAgICBsaW5rLmhyZWYgPSB1cmw7XHJcbiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChsaW5rKTtcclxuICAgICAgICBsaW5rLmNsaWNrKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQWxsIG90aGVyIGJyb3dzZXJzIGNhbiB1c2UgdGhlIHN0YW5kYXJkIHdpbmRvdy5sb2NhdGlvbi5ocmVmICh0aGV5IGRvbid0IGxvc2UgSFRUUF9SRUZFUkVSIGxpa2UgSW50ZXJuZXQgRXhwbG9yZXIgOCAmIGxvd2VyIGRvZXMpXHJcbiAgICBlbHNlIHtcclxuICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IHVybDtcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gc2l6ZU9iaihvYmopIHtcclxuICAgIHZhciBzaXplID0gMCwga2V5O1xyXG4gICAgZm9yIChrZXkgaW4gb2JqKSB7XHJcbiAgICAgICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShrZXkpKSBzaXplKys7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gc2l6ZTtcclxufSJdfQ==
